<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>–°–∫—Ä–∏–Ω—à–æ—Ç –ª–∏—Ü–∞</title>
    <style>
      body {
        text-align: center;
        font-family: Arial, sans-serif;
      }
      video,
      canvas {
        display: block;
        margin: 10px auto;
      }
      button {
        padding: 10px;
        font-size: 16px;
        cursor: pointer;
      }
    </style>
  </head>
  <body>
    <h2>–°–∫—Ä–∏–Ω—à–æ—Ç —Å –∫–∞–º–µ—Ä—ã</h2>
    <video id="video" width="320" height="240" autoplay></video>
    <button id="snap">üì∏ –°–¥–µ–ª–∞—Ç—å —Ñ–æ—Ç–æ</button>
    <a id="download" style="display: none">‚¨áÔ∏è –°–∫–∞—á–∞—Ç—å —Ñ–æ—Ç–æ</a>
    <canvas id="canvas" width="320" height="240" style="display: none"></canvas>

    <script>
      const video = document.getElementById("video");
      const canvas = document.getElementById("canvas");
      const context = canvas.getContext("2d");
      const snapButton = document.getElementById("snap");
      const downloadLink = document.getElementById("download");

      // –ó–∞–ø—É—Å–∫ –∫–∞–º–µ—Ä—ã
      navigator.mediaDevices
        .getUserMedia({ video: true })
        .then((stream) => {
          video.srcObject = stream;
        })
        .catch((err) => {
          console.error("–û—à–∏–±–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –∫–∞–º–µ—Ä–µ: ", err);
        });

      // –°–¥–µ–ª–∞—Ç—å —Ñ–æ—Ç–æ –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å
      snapButton.addEventListener("click", () => {
        context.drawImage(video, 0, 0, canvas.width, canvas.height);
        const imageUrl = canvas.toDataURL("image/png");

        // –°–æ–∑–¥–∞–Ω–∏–µ —Å—Å—ã–ª–∫–∏ –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è
        downloadLink.href = imageUrl;
        downloadLink.download = `screenshot_${Date.now()}.png`;
        downloadLink.style.display = "block";
        downloadLink.textContent = "‚¨áÔ∏è –°–∫–∞—á–∞—Ç—å —Ñ–æ—Ç–æ";
      });
    </script>
  </body>
</html>

